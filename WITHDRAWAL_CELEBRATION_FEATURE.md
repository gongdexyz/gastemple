# 提现对话框庆祝动画功能

## 实现时间
2026-01-25

## 功能概述
为提现对话框（WithdrawalDialog）添加了税率升级庆祝动画系统，当用户质押 SKR 并刷新状态后，如果等级提升，会触发视觉庆祝效果。

## 核心功能

### 1. 彩带庆祝动画
- **触发条件**：用户等级提升时（税率降低）
- **视觉效果**：
  - 30 个彩色粒子从中心向四周爆炸扩散
  - 粒子颜色：金色、橙色、粉色、青色、绿色随机
  - 粒子形状：圆形或方形随机
  - 持续时间：2-3 秒
  - 带旋转和淡出效果

### 2. 等级提升提示
- **视觉元素**：
  - 中心弹出式提示框
  - 显示 "TIER UP!" / "等级提升！"
  - 显示新等级的 emoji 和名称
  - 带缩放动画（0 → 1.2 → 1）
  - 半透明背景 + 毛玻璃效果

### 3. 税率高光动画
- **效果**：
  - 税率数字放大（1 → 1.5 → 1）
  - 金色发光效果（text-shadow）
  - 持续 0.8 秒
  - 仅在等级提升时触发

### 4. 面板边框闪光
- **效果**：
  - 等级显示面板外发光
  - 金色光晕（box-shadow）
  - 闪烁 2 次
  - 每次持续 1 秒

### 5. Seeker 品牌按钮优化
- **改进**：
  - 使用 Seeker 品牌色（青色到蓝色渐变）
  - 添加 Sparkles 图标
  - hover 时放大效果（scale-105）
  - 渐变背景 + 边框
  - 链接指向 Seeker 官方质押页面

## 技术实现

### 状态管理
```typescript
const [showCelebration, setShowCelebration] = useState(false)
const [tierUpgraded, setTierUpgraded] = useState(false)
const previousTierRef = useRef<StakingTier>(STAKING_TIERS[0])
```

### 等级检测逻辑
```typescript
// 在刷新和初始加载时检测等级变化
if (newTier.minStake > previousTierRef.current.minStake) {
  setTierUpgraded(true)
  setShowCelebration(true)
  setTimeout(() => {
    setShowCelebration(false)
    setTierUpgraded(false)
  }, 3000)
}
```

### 动画库
- **Framer Motion**：用于所有动画效果
- **AnimatePresence**：管理庆祝动画的进入/退出

## 用户体验流程

1. **用户打开提现对话框**
   - 显示当前等级和税率
   - 如果税率高，显示升级提示

2. **用户去 Seeker 官网质押 SKR**
   - 点击 "去 Seeker 官网质押" 按钮
   - 在新标签页打开 Seeker 官方质押页面

3. **用户质押完成后返回**
   - 点击 "刷新" 按钮
   - 系统检测到 SKR 余额增加

4. **触发庆祝动画**（如果等级提升）
   - 彩带粒子爆炸
   - 中心弹出 "TIER UP!" 提示
   - 税率数字发光放大
   - 面板边框闪烁
   - 持续 3 秒后自动消失

5. **用户享受低税率提现**
   - 税率从 30% 降至 10% 或 0%
   - 节省大量 $GONGDE

## 黑客松演示重点

### 录制建议
1. **开场**：展示 30% 税率的路人状态
2. **中间**：点击 "去 Seeker 官网质押"（可以用测试模式模拟）
3. **高潮**：点击刷新，触发庆祝动画
4. **结尾**：展示 0% 税率，计算节省金额

### 话术要点
- "这不是简单的游戏，而是 Seeker 生态的 Layer-2 忠诚度计划"
- "用户为了免税，会主动去 Seeker 官方质押 SKR"
- "我们不与官方争夺流动性，而是为官方导流"
- "一份 SKR，赚两份钱：官方 APY + 游戏免税"

## 文件修改

### 修改的文件
- `src/components/WithdrawalDialog.tsx`

### 新增依赖
- `Sparkles` 图标（来自 lucide-react）

### 移除的依赖
- `AlertTriangle` 图标（未使用）

## 测试建议

### 手动测试
1. 连接钱包（测试模式）
2. 打开提现对话框
3. 模拟 SKR 余额变化
4. 点击刷新按钮
5. 观察庆祝动画

### 边界情况
- 等级不变时不触发动画
- 等级降低时不触发动画（理论上不会发生）
- 首次加载时不触发动画

## 后续优化建议

1. **音效**：添加升级音效（金币声、欢呼声）
2. **粒子优化**：使用 Canvas 渲染更多粒子
3. **动画预设**：为不同等级设计不同的庆祝效果
4. **社交分享**：添加 "分享我的等级" 按钮
5. **成就系统**：记录用户的等级提升历史

## 性能考虑

- 彩带粒子数量：30 个（平衡视觉效果和性能）
- 动画持续时间：3 秒（不会过长影响用户操作）
- 使用 CSS transform 而非 position（GPU 加速）
- 动画结束后自动清理状态（避免内存泄漏）

## 品牌一致性

- 使用 Seeker 品牌色（青色 #00CED1）
- 强调 "Powered by Seeker" 定位
- 所有外链指向 Seeker 官方域名
- 文案突出 "生态赋能" 而非 "竞争"
